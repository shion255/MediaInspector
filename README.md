# MediaInspector

動画ファイルとオンライン動画のメタデータを解析・表示する PowerShell 製 GUI ツールです。

## 概要

MediaInspector は、yt-dlp と MediaInfo CLI を活用して、動画ファイルの詳細情報を簡単に取得・表示できるツールです。YouTube などのオンライン動画の情報取得や、ローカルファイルのコーデック情報、ビットレート、解像度などを一括で解析できます。

## 主な機能

### 🎬 動画解析
- **オンライン動画**: yt-dlp 対応サイトの URL 解析
- **ローカルファイル**: MediaInfo によるメディアファイル解析
- **フォルダ一括解析**: サブフォルダを含む一括処理に対応

### 📊 表示情報
- 再生時間、ビットレート、ファイルサイズ
- 映像: コーデック、解像度、FPS、HDR/SDR、ビットレート
- 音声: コーデック、サンプリングレート、ビットレート、リプレイゲイン
- 字幕/テキストストリーム情報
- カバー画像情報
- チャプター有無
- 作成者 （Artist/Performer） 情報

### 🎨 カスタマイズ
- **テーマ**: ダーク/ライトテーマ切り替え
- **フォント**: 表示フォントとサイズの変更
- **透明度**: ウィンドウの透明度調整
- **表示項目**: 必要な情報のみ選択表示

### 🔍 便利機能
- **結果フィルタリング**: コーデックや HDR/SDR 別に絞り込み
- **ファイル整理**: 作成者情報を基にフォルダ分け
- **履歴管理**: 過去の入力を保存・再利用
- **別ウィンドウ表示**: 複数ファイルの比較が容易
- **コピー機能**: 結果をクリップボードにコピー

## 必要な環境

### 1. PowerShell
- **推奨**: PowerShell 5.1 以降

### 2. yt-dlp
オンライン動画の情報取得に使用

- **ダウンロード**: https://github.com/yt-dlp/yt-dlp/releases
- **推奨**: `yt-dlp.exe`をダウンロード

### 3. MediaInfo CLI
動画ファイルの詳細情報取得に使用

- **ダウンロード**: https://mediaarea.net/en/MediaInfo/Download/Windows
- **推奨**: CLI (Command Line Interface) 版をダウンロード

## インストール

1. このリポジトリをクローンまたはダウンロード
```bash
git clone https://github.com/shion255/MediaInspector.git
```

2. 初回起動時にメニュー「ツール」→「オプション」から、yt-dlp と MediaInfo CLI のパスを設定

## 使い方

### 基本的な使い方

1. **URL 解析**
   - テキストボックスに YouTube などの URL を入力
   - 「解析開始」ボタンをクリック

2. **ローカルファイル解析**
   - ファイルのフルパスを入力
   - ファイルをドラッグ & ドロップ
   - または「ファイル」→「ファイルを追加」から選択
   - 複数ファイルの一括解析に対応

4. **フォルダ解析**
   - フォルダのフルパスを入力
   - 「ファイル」→「フォルダを追加」から選択
   - オプションでサブフォルダを含めるか選択可能

### 高度な使い方

#### 結果のフィルタリング
1. 「ツール」→「解析結果から絞り込み」を選択
2. コーデックや HDR/SDR の条件を選択
3. 条件に合致するファイルのみを表示

#### ファイル整理
1. 「ツール」→「動画ファイルを整理」を選択
2. 整理したいフォルダを選択
3. 作成者情報を基に自動的にフォルダ分け

#### 別ウィンドウ表示
- 「結果を別ウィンドウ表示」ボタンで、各ファイルの情報を個別のウィンドウに表示
- 複数の動画を比較する際に便利

## 設定項目

「ツール」→「オプション」から以下を設定できます。

### 全般タブ
- テーマ（ダーク/ライト）
- フォント名とサイズ
- ウィンドウの透明度
- yt-dlp のパス
- MediaInfo CLI のパス

### 解析タブ
- サブフォルダを含めるか
- 履歴の最大保存数
- 表示する解析項目の選択

## トラブルシューティング

### 「ツールが見つかりません」エラー
- オプションで yt-dlp と MediaInfo のパスが正しく設定されているか確認
- ファイルが実際に存在するか確認

### 文字化けが発生する
- PowerShell の文字コードを UTF-8 に設定 （スクリプト内で自動設定）
- フォント設定で日本語対応フォントを選択

## ライセンス

MIT License

## 作者

[Shion](https://github.com/shion255)